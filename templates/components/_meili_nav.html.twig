{# A tiny, framework-free header bar that the bundle owns. #}
{% set embedders = indexConfig.embedders|default([]) %}
<div class="meili-bar">
  <a href="/">/</a>
  {% for indexName, indexSettings in allSettings|default([]) %}
      <li>
        <a href="{{ path('meili_insta', {indexName: indexSettings.prefixedName}) }}">
          {{ ux_icon('mdi:search') }}
          {{ indexName }}</a>
      </li>
  {% endfor %}
  <div class="meili-bar-left">
    {% if indexName %}
      <span class="meili-chip">
        Index: <strong>{{ indexName }}</strong>
      </span>
    {% endif %}

    {% if indexStats and indexStats.numberOfDocuments is defined %}
      <span class="meili-chip" title="Documents in index">
        Docs: {{ indexStats.numberOfDocuments|number_format(0, '.', ',') }}
      </span>
    {% endif %}
  </div>

  <div class="meili-bar-right">
    {% if embedders|length > 0 %}
      <span class="meili-chip-label">Semantic:</span>
      {% for name in embedders %}
        <a class="meili-badge {{ name == embedder ? 'is-active' : '' }}"
           href="{{ path('meili_insta_embed', { indexName: indexName, embedder: name }) }}">
          {{ name == embedder ? 'â˜… ' : '' }}{{ name }}
        </a>
      {% endfor %}
      {% if embedder %}
        <a class="meili-link ms-2"
           href="{{ path('meili_insta', { indexName: indexName }) }}">
          Switch to keyword
        </a>
      {% endif %}
    {% endif %}

      {% import '@SurvosMeili/babel/_locale_switcher.html.twig' as Babel %}

      {# Determine current route and params dynamically #}
      {% set _route = app.request.attributes.get('_route') %}
      {% set _params = app.request.attributes.get('_route_params') %}

      {{ Babel.locale_switcher(
          locales = app.enabled_locales,
          currentLocale = app.request.locale,
          routeName = _route,
          routeParams = _params
      ) }}

      @locale?
  </div>
</div>
